  <!-- ========================= MAIN CONTENT ========================= -->
  <section class="content">
      <div class="container-fluid">

          <!-- ===== ROW 1: Small boxes ===== -->
          <div class="row">
              <% small_boxes = [
          {count: User.count, label: "Người dùng", icon: "fas fa-users", color: "info", path: admin_users_path},
          {count: Category.count, label: "Danh mục", icon: "fas fa-list", color: "secondary", path: admin_categories_path},
          {count: FoodDrink.count, label: "Sản phẩm", icon: "fas fa-utensils", color: "success", path: admin_food_drinks_path},
          {count: Order.count, label: "Đơn hàng", icon: "fas fa-shopping-cart", color: "warning", path: admin_orders_path},
          {count: Suggestion.count, label: "Góp ý", icon: "fas fa-comment-dots", color: "primary", path: admin_suggestions_path},
          {count: Order.count, label: "Thống kê", icon: "fas fa-chart-line", color: "danger", path: admin_order_statistics_path}
        ] %>

              <% small_boxes.each do |box| %>
              <div class="col-lg-3 col-6">
                  <div class="small-box bg-<%= box[:color] %>">
                      <div class="inner">
                          <h3><%= box[:count] %></h3>
                          <p><%= box[:label] %></p>
                      </div>
                      <div class="icon">
                          <i class="<%= box[:icon] %>"></i>
                      </div>
                      <%= link_to "Chi tiết", box[:path], class: "small-box-footer" %>
                  </div>
              </div>
              <% end %>
          </div>

          <!-- ===== ROW 2: CHARTS ===== -->
          <div class="row">
              <section class="col-lg-6 connectedSortable">
                  <div class="card">
                      <div class="card-header">
                          <h3 class="card-title"><i class="fas fa-chart-line"></i> Doanh thu</h3>
                      </div>
                      <div class="card-body">
                          <canvas id="lineChart" style="width:100%; height:300px;"></canvas>
                      </div>
                  </div>
              </section>

              <section class="col-lg-6 connectedSortable">
                  <div class="card">
                      <div class="card-header">
                          <h3 class="card-title"><i class="fas fa-chart-bar"></i> Số đơn hàng</h3>
                      </div>
                      <div class="card-body">
                          <canvas id="barChart" style="width:100%; height:300px;"></canvas>
                      </div>
                  </div>
              </section>
          </div>

          <!-- ===== ROW 3: DONUT + MEMBERS ===== -->
          <div class="row">
              <!-- Donut Chart -->
              <section class="col-lg-4">
                  <div class="card card-danger">
                      <div class="card-header">
                          <h3 class="card-title">Tỷ lệ sản phẩm</h3>
                      </div>
                      <div class="card-body">
                          <canvas id="donutChart" data-labels="<%= @fooddrink_counts.keys.to_json %>" data-values="<%= @fooddrink_counts.values.to_json %>" style="width:100%; height:300px;"></canvas>
                      </div>
                  </div>
              </section>


              <section class="col-lg-8">
                  <div class="card">
                      <div class="card-header border-transparent">
                          <h3 class="card-title">Thành viên mới</h3>
                      </div>

                      <div class="card-body p-0">
                          <ul class="users-list clearfix p-3">
                              <% User.order(created_at: :desc).limit(8).each do |u| %>
                              <li class="text-center">
                                  <img src="https://ui-avatars.com/api/?name=<%= u.name || 'User' %>" class="img-circle" width="70">
                                  <a class="users-list-name" href="#"><%= u.name || "No name" %></a>
                                  <span class="users-list-date"><%= u.created_at.strftime("%d/%m") %></span>
                              </li>
                              <% end %>
                          </ul>
                      </div>

                  </div>
              </section>
          </div>

          <!-- ===== RECENT ORDERS ===== -->
          <div class="card bg-dark text-white mt-4">
              <div class="card-header border-0 bg-dark">
                  <h3 class="card-title text-white">Đơn hàng gần đây</h3>
              </div>

              <div class="card-body p-0">
                  <table class="table table-dark table-striped m-0">
                      <thead class="thead-dark">
                          <tr>
                              <th>Mã</th>
                              <th>Khách hàng</th>
                              <th>Tổng</th>
                              <th>Ngày</th>
                              <th>Trạng thái</th>
                          </tr>
                      </thead>
                      <tbody>
                          <% Order.order(created_at: :desc).limit(10).each do |o| %>
                          <tr>
                              <td><%= o.id %></td>
                              <td><%= o.user&.name || "N/A" %></td>
                              <td><%= number_to_currency(o.total_price, unit: "₫") %></td>
                              <td><%= o.created_at.strftime("%d/%m/%Y") %></td>
                              <td>
                                  <% badge_class = case o.status
                      when "pending" then "badge-warning"
                      when "processing" then "badge-info"
                      when "completed" then "badge-success"
                      when "cancelled" then "badge-danger"
                      when "delivering" then "badge-primary"
                      when "confirmed" then "badge-secondary"
                      else "badge-light"
                    end %>

                                  <span class="badge <%= badge_class %>">
                                      <%= case o.status
                        when "pending" then "Đang chờ"
                        when "processing" then "Đang xử lý"
                        when "completed" then "Hoàn thành"
                        when "cancelled" then "Đã hủy"
                        when "delivering" then "Đang giao"
                        when "confirmed" then "Đã xác nhận"
                        else o.status
                      end %>
                                  </span>
                              </td>
                          </tr>
                          <% end %>
                      </tbody>
                  </table>
              </div>
          </div>

          <!-- ===== TO-DO LIST ===== -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">To-Do List</h3>
              </div>
              <div class="card-body">
                  <ul class="todo-list" data-widget="todo-list">
                      <li><span class="text">Kiểm tra đơn hàng mới</span><small class="badge badge-danger"><i class="far fa-clock"></i> 1 giờ</small>
                          <div class="tools"><i class="fas fa-edit"></i><i class="fas fa-trash"></i></div>
                      </li>
                      <li><span class="text">Duyệt món mới</span><small class="badge badge-warning"><i class="far fa-clock"></i> Hôm nay</small>
                          <div class="tools"><i class="fas fa-edit"></i><i class="fas fa-trash"></i></div>
                      </li>
                      <li><span class="text">Phản hồi góp ý</span><small class="badge badge-success"><i class="far fa-clock"></i> 3 ngày</small>
                          <div class="tools"><i class="fas fa-edit"></i><i class="fas fa-trash"></i></div>
                      </li>
                  </ul>
              </div>
          </div>
      </div>
  </section>

  </div>
  </section>

  <!-- CHART.JS -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <%= javascript_include_tag 'dashboard', 'data-turbo-track': 'reload' %>