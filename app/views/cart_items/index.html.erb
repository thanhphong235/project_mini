<div class="d-flex justify-content-between align-items-center mb-4">
    <%= link_to "Quay lại", food_drinks_path, class: "btn btn-outline-secondary" %>
    <h1 class="text-center flex-grow-1 mb-0">Giỏ hàng của Bạn</h1>
</div>
<% if @cart_items.any? %>
<table class="table table-striped">
    <thead>
        <tr>
            <th>#</th>
            <th>Món ăn / Thức uống</th>
            <th>Giá</th>
            <th>Số lượng</th>
            <th>Tổng</th>
            <th>Hành động</th>
        </tr>
    </thead>
    <tbody>
        <% @cart_items.each_with_index do |item, index| %>
        <!-- Đặt id đúng để Turbo Stream remove hoạt động -->
        <tr id="<%= dom_id(item) %>">
            <td><%= index + 1 %></td>
            <td><%= item.food_drink.name %></td>
            <td><%= number_to_currency(item.food_drink.price, unit: "₫") %></td>
            <td>
                <%= form_with model: item, url: cart_item_path(item), method: :patch, local: false do |f| %>
                <%= f.number_field :quantity, min: 1, value: item.quantity, class: "form-control", style: "width:80px;" %>
                <%= f.submit "Cập nhật", class: "btn btn-sm btn-primary mt-1" %>
                <% end %>
            </td>
            <td><%= number_to_currency(item.food_drink.price * item.quantity, unit: "₫") %></td>
            <td>
                <%= button_to "Xóa", cart_item_path(item), method: :delete, data: { turbo_confirm: "Bạn có chắc muốn xóa món này?" }, class: "btn btn-sm btn-danger" %>
            </td>
        </tr>
        <% end %>
    </tbody>
</table>

<!-- Tổng tiền và nút đặt hàng -->
<div id="cart-summary" class="text-end mt-3">
    <p><strong>Tổng cộng:</strong> <%= number_to_currency(@total_price, unit: "₫") %></p>
    <%= button_to "Đặt hàng", orders_path, method: :post, class: "btn btn-success btn-lg" %>
</div>

<% else %>
<p>Giỏ hàng của bạn đang trống.</p>
<% end %>