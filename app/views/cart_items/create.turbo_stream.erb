<%= turbo_stream.replace "food_drink_#{@cart_item.food_drink.id}_stock" do %>
  <%= @cart_item.food_drink.stock > 0 ? @cart_item.food_drink.stock : "Hết hàng" %>
<% end %>

<%= turbo_stream.replace "food_drink_#{@cart_item.food_drink.id}_button" do %>
  <% if @cart_item.food_drink.stock > 0 %>
    <%= button_to "Thêm vào giỏ",
                  cart_items_path,
                  method: :post,
                  params: { food_drink_id: @cart_item.food_drink.id },
                  form: { data: { turbo_stream: true, turbo_frame: "_top" } },
                  class: "btn btn-sm btn-outline-success" %>
  <% else %>
    <button class="btn btn-sm btn-outline-secondary" disabled>Hết hàng</button>
  <% end %>
<% end %>

<%= turbo_stream.replace "cart-count" do %>
  <%= turbo_frame_tag "cart-count" do %>
    <%= link_to cart_path, class: "nav-link position-relative", data: { turbo_frame: "_top" } do %>
      <i class="bi bi-cart-fill" style="font-size: 1.3rem;"></i>
      <% count = current_user.cart_items.sum(:quantity) %>
      <% if count > 0 %>
        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
          <%= count %>
        </span>
      <% end %>
    <% end %>
  <% end %>
<% end %>
