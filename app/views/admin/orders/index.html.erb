<div class="d-flex justify-content-between align-items-center mb-4">
    <%= link_to "Quay lại", admin_dashboard_path, class: "btn btn-outline-secondary" %>
    <h1 class="text-center flex-grow-1 mb-0"> Danh sách Đơn hàng</h1>
</div>
<table class="table table-striped table-hover align-middle mt-3">
    <thead class="table-dark">
        <tr>
            <th>#</th>
            <th>Người đặt</th>
            <th>Tổng tiền</th>
            <th>Trạng thái</th>
            <th>Ngày đặt</th>
            <th>Hành động</th>
        </tr>
    </thead>
    <tbody>
        <% @orders.each_with_index do |order, index| %>
        <tr>
            <td><%= index + 1 %></td>
            <td><%= order.user.name || order.user.email %></td>
            <td><%= number_to_currency(order.total_price, unit: "₫") %></td>

            <!-- Cập nhật trạng thái -->
            <td>
                <%= form_with model: [:admin, order], local: true, class: "d-flex align-items-center gap-2" do |f| %>
                <%= f.select :status,
                  Order.statuses.keys.map { |s| [Order.status_human_for(s), s] },
                  { selected: order.status },
                  class: "form-select form-select-sm" %>
                <%= f.submit "Cập nhật", class: "btn btn-sm btn-outline-success" %>
                <% end %>
            </td>

            <td><%= order.created_at.strftime("%d/%m/%Y %H:%M") %></td>

            <td class="d-flex">
                <%= link_to "Xem", admin_order_path(order), class: "btn btn-sm btn-outline-primary me-1" %>
                <%= button_to "Xóa", admin_order_path(order),
              method: :delete,
              data: { turbo_confirm: "Bạn có chắc chắn muốn xóa đơn hàng này?" },
              class: "btn btn-sm btn-outline-danger" %>
            </td>
        </tr>
        <% end %>
    </tbody>
</table>