<div class="order-statistics container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <%= link_to "Quay l·∫°i", admin_dashboard_path, class: "btn btn-outline-secondary" %>
        <h1 class="mb-4 text-center flex-grow-1 mb-0">Th·ªëng k√™ ƒë∆°n h√†ng th√°ng <%= @month %>/<%= @year %></h1>
    </div>
    <!-- Form ch·ªçn th√°ng v√† nƒÉm -->
    <%= form_with url: admin_order_statistics_path, method: :get, local: true, class: "mb-4 d-flex align-items-center gap-2" do %>
    <div>
        <label for="month">Th√°ng:</label>
        <%= select_tag :month, options_for_select(1..12, @month.to_i), class: "form-select d-inline w-auto mx-2" %>
    </div>

    <div>
        <label for="year">NƒÉm:</label>
        <%= select_tag :year, options_for_select((2023..Time.current.year).to_a.reverse, @year.to_i), class: "form-select d-inline w-auto mx-2" %>
    </div>

    <%= submit_tag "Xem", class: "btn btn-primary" %>
    <% end %>
    <%= button_to "üì© G·ª≠i th·ªëng k√™ qua email",
                    admin_send_monthly_report_path(month: @month, year: @year),
                    method: :post,
                    class: "btn btn-success mb-3",
                    data: { confirm: "B·∫°n c√≥ ch·∫Øc mu·ªën g·ª≠i b√°o c√°o th·ªëng k√™ th√°ng n√†y qua email?" } %>


    <!-- K·∫øt qu·∫£ th·ªëng k√™ -->
    <div class="mb-3">
        <p><strong>T·ªïng s·ªë ƒë∆°n h√†ng:</strong> <%= @total_orders %></p>
        <p><strong>T·ªïng doanh thu:</strong> <%= number_to_currency(@total_revenue, unit: "‚Ç´", delimiter: ".", precision: 0) %></p>
    </div>

    <!-- B·∫£ng danh s√°ch ƒë∆°n h√†ng -->
    <% if @orders.any? %>
    <table class="table table-striped mt-3">
        <thead>
            <tr>
                <th>ID ƒë∆°n</th>
                <th>Ng∆∞·ªùi d√πng</th>
                <th>Ng√†y ƒë·∫∑t</th>
                <th>T·ªïng ti·ªÅn</th>
                <th>Tr·∫°ng th√°i</th>
            </tr>
        </thead>
        <tbody>
            <% @orders.each do |order| %>
            <tr>
                <td><%= order.id %></td>
                <td><%= order.user&.email || "Kh√¥ng x√°c ƒë·ªãnh" %></td>
                <td><%= order.created_at.strftime("%d/%m/%Y") %></td>
                <td><%= number_to_currency(order.total_price, unit: "‚Ç´", delimiter: ".", precision: 0) %></td>
                <td>
                    <%# N·∫øu status l√† enum, hi·ªÉn th·ªã ƒë·∫πp h∆°n %>
                    <%= order.status.is_a?(Integer) ? Order.statuses.key(order.status) : order.status %>
                </td>
            </tr>
            <% end %>
        </tbody>
    </table>
    <% else %>
    <p class="text-muted">Kh√¥ng c√≥ ƒë∆°n h√†ng n√†o trong th√°ng n√†y.</p>
    <% end %>
</div>