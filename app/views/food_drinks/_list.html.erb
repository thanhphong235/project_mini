<div class="row mt-3">
    <% food_drinks.each do |fd| %>
    <div class="col-md-4 mb-3">
        <div class="card shadow-sm h-100">
            <% if fd.image.attached? %>
            <%= image_tag fd.image, class: "card-img-top", style: "height: 200px; object-fit: cover;" %>
            <% else %>
            <div class="bg-secondary text-white d-flex align-items-center justify-content-center" style="height: 200px;">
                Không có ảnh
            </div>
            <% end %>

            <div class="card-body d-flex flex-column">
                <h5 class="card-title"><%= link_to fd.name, food_drink_path(fd) %></h5>
                <p class="card-text"><strong>Giá:</strong> <%= number_to_currency(fd.price, unit: "₫") %></p>
                <p class="card-text"><strong>Danh mục:</strong> <%= fd.category&.name || "Không có" %></p>

                <p class="card-text">
                    <strong>Số lượng còn:</strong>
                    <%= turbo_frame_tag "food_drink_#{fd.id}_stock" do %>
                    <%= fd.stock > 0 ? fd.stock : "Hết hàng" %>
                    <% end %>
                </p>

                <div class="mt-auto d-flex gap-1">
                    <%= link_to "Xem chi tiết", food_drink_path(fd), class: "btn btn-sm btn-outline-primary" %>

                    <%= turbo_frame_tag "food_drink_#{fd.id}_button" do %>
                    <% if fd.stock > 0 %>
                    <%= button_to "Thêm vào giỏ",
                  cart_items_path,
                  method: :post,
                  params: { food_drink_id: fd.id },
                  form: { data: { turbo_stream: true, turbo_frame: "_top" } },
                  class: "btn btn-sm btn-outline-success" %>
                    <% else %>
                    <button class="btn btn-sm btn-outline-secondary" disabled>Hết hàng</button>
                    <% end %>
                    <% end %>
                </div>
            </div>
        </div>
    </div>
    <% end %>

    <% if food_drinks.empty? %>
    <p class="text-center text-muted mt-4">Không tìm thấy món nào phù hợp.</p>
    <% end %>
</div>